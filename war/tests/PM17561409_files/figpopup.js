if(typeof jQuery!=="undefined"&&typeof jQuery.fn!=="undefined"&&typeof jQuery.fn.hoverIntent!=="undefined"){(function(c){var b="mouseenter";var C="mouseleave";var h="evtTS.sensor";var o="mouse.in.sensor";var z="mouse.out.sensor";var I="mouse.in.canvas";var x="mouse.out.canvas";var d="show.canvas";var s="hide.canvas";var a="shown.canvas";var B="gone.canvas";var n="left";var K="right";var v="top";var u="bottom";var m=15;var i=500;var y="hover";var G=400;var F=200;var D=250;var p=150;c.fn.popupSensor=function(O){var P={statIfLonger:i,delayIn:F,delayOut:D};var N=c.fn.extend({},P);c.fn.extend(N,O);return this.each(function(Q){var R=c(this);R.bind(o,q);R.bind(z,j);R.bind(I,J);R.bind(x,w);R.bind(B,l);R.bind(a,M);R.data("popupSensor.cfg",c.extend({},N))})};function q(P){var Q=c(this);Q.data("__sensor.mouseIn",true);Q.bind(b,g);var N=A(Q);if(typeof Q.data(h)==="undefined"||Q.data(h)===null){Q.data(h,P.timeStamp);var O=L(Q);if(typeof O!=="undefined"){O.getCanvasElm().trigger(d)}}}function j(N){var O=c(this);O.data("__sensor.mouseIn",false);r.apply(this,[N])}function g(N){var O=c(this);O.data("__sensor.instantMouseIn",true);O.bind(C,t)}function t(P){var Q=c(this);var N=A(Q);var O=this;Q.unbind(C,t);Q.data("__sensor.instantMouseIn",false);setTimeout(function(){r.apply(O,[P])},N.delayOut)}function J(N){var O=c(this);O.data("__canvas.mouseIn",true)}function w(N){var O=c(this);O.data("__canvas.mouseIn",false);r.apply(this,[N])}function r(O){var P=c(this);var N=L(P);if(typeof N!=="undefined"&&P.data("__canvas.mouseIn")!==true&&P.data("__sensor.mouseIn")!==true&&P.data("__sensor.instantMouseIn")!==true&&P.data("__canvas.shown")===true){N.getCanvasElm().trigger(s)}}function M(N){var O=c(this);O.data("__canvas.shown",true)}function l(R){var S=c(this);var N=A(S);S.data("__canvas.shown",false);S.unbind(b,g);if(typeof ncbi!=="undefined"&&typeof ncbi.sg!=="undefined"&&typeof ncbi.sg.ping!=="undefined"&&typeof S.data(h)!=="undefined"){var P=R.timeStamp-S.data(h);var O="lifespan="+P;var Q=[];Q.push("jsevent="+y);Q.push(O);if(typeof S.attr("ref")!=="undefined"){Q.push(S.attr("ref"))}if(N.statIfLonger<P){ncbi.sg._version>=10?ncbi.sg.ping(this,R,y,[O]):ncbi.sg.ping(Q)}}if(typeof S.data(h)!=="undefined"){S.data(h,null)}}function A(N){return N.data("popupSensor.cfg")}function L(P){var O=P.data("popupSensor.popupCanvas");var N=A(P);if(typeof O==="undefined"){O=new H({el:P,delayOut:Math.max(N.delayOut,N.delayIn),delayIn:N.delayIn});if(typeof O!=="undefined"){P.attr("canvas-rid",O.getCanvasElm().attr("id"));f(P,O)}}return O}function f(O,N){O.data("popupSensor.popupCanvas",N)}function k(N){}function E(N){}function e(){console.info.apply(this,arguments)}var H=function(N){this.__name="popupCanvas";this.__cfgDefaults={delayIn:F,delayOut:D};this.__cfg={};this.__canvas=undefined;this.__imToLoad=0;this.__imagesBox=undefined;this.__legendBox=undefined;return(this.__init(N)===true?this:undefined)};c.fn.extend(H.prototype,{__init:function(P){c.fn.extend(this.__cfg,this.__cfgDefaults);c.fn.extend(this.__cfg,P);var O=this.__newCanvas();if(O){var N=this;this.bind(b,function(Q){N.__in(Q)});this.bind(C,function(Q){N.__out(Q)});this.bind(d,function(Q){N.show(Q)});this.bind(s,function(Q){N.hide(Q)})}return O},__in:function(O){var N=this.__cfg;var P=N.el;P.trigger(I)},__out:function(O){var N=this.__cfg;var P=N.el;setTimeout(function(){P.trigger(x)},N.delayOut)},__newCanvas:function(){var N=this.__cfg;var O=N.el;var Q=undefined;this.__canvas=c('<div class="co co-default"><div class="co-inner"></div></div>');if(typeof O!=="undefined"){if(typeof O.attr("rid-figpopup")!=="undefined"){Q=this.__collectHiresImgs(c(c("#"+O.attr("rid-figpopup"))[0]))}else{if(typeof O.attr("co-rid")!=="undefined"){c("#"+O.attr("co-rid")).clone().removeAttr("id").show().appendTo(this.__getCanvasInner());Q=O.attr("co-rid")}else{if(typeof O.attr("co-content")!=="undefined"){Q=""+Math.floor(Math.random()*1000000);this.addContent(O.attr("co-content"))}else{Q=this.__collectHiresImgs(O)}}}}if(typeof Q!=="undefined"){var P=this.getCanvasElm();if(typeof O.attr("co-legend")=="string"){this.addLegend(O.attr("co-legend"))}if(typeof O.attr("co-legend-rid")=="string"){this.addLegendRid(O.attr("co-legend-rid"))}if(typeof O.attr("co-class")=="string"){this.addClass(O.attr("co-class"))}if(typeof O.attr("co-style")=="string"){this.addStyle(O.attr("co-style"))}P.appendTo(c(document.body));P.attr("id",String("_cid_"+Q).replace(/\W+/g,"_"));O.attr("canvas-rid",P.attr("id"));if(typeof ncbi!=="undefined"&&typeof ncbi.sg!=="undefined"&&typeof ncbi.sg.ping!=="undefined"){ncbi.sg.scanLinks(P.find("a").tmpfixPMCLinks().get())}}return typeof Q!=="undefined"?true:false},__collectHiresImgs:function(O){var P=undefined;var N=this;if(typeof O!=="undefined"){O.find("img[src-large], img[hires]").each(function(){var Q=c(this);if(typeof Q.attr("src-large")==="undefined"){Q.attr("src-large",Q.attr("hires"))}if(typeof P==="undefined"){P=""}P+="_"+Q.attr("src-large")+"_";N.addImage(Q)})}return P},bind:function(O,N){this.__canvas.bind(O,N)},show:function(O){var N=this.__cfg;var P=N.el;this.__canvas.show();this.__canvasArrangeLocation();P.trigger(a)},hide:function(O){var N=this.__cfg;var P=this.__cfg.el;this.__canvas.hide();P.trigger(B)},addImage:function(Q){var P=this.__cfg;var U=P.el;if(typeof Q.attr("src-large")!=="undefined"){this.__imToLoad+=1;if(this.__imToLoad===1){this.__imagesBox=c('<div class="images-box inline-block"></div>');this.__imagesBox.appendTo(this.__getCanvasInner())}var O;var T=U.closest("a");var S=Q.attr("alt");if(S===undefined){S=""}var N=c('<img class="large-thumb" alt="'+S+'" src="'+Q.attr("src-large")+'" />');if(typeof T!=="undefined"){O=c("<a></a>")}if(typeof O!=="undefined"){c.each(["href","ref","target"],function(V,W){if(T.attr(W)!==""){O.attr(W,T.attr(W))}});O.bind("click",{},function(V){V.stopPropagation();T.trigger(V);return V.result===false?false:true});N.appendTo(O.appendTo(c('<div class="inline-block"></div>').appendTo(this.__imagesBox)))}else{N.appendTo(c('<div class="inline-block"></div>').appendTo(this.__imagesBox))}var R=this;if(N.data("loaded")!==true){N.parent().addClass("in-progress");N.load(function(){var V=c(this);V.data("loaded",true);V.show();V.parent().removeClass("in-progress");R.__imToLoad-=1;R.__canvasArrangeLocation()})}}},addLegend:function(N){this.__legendBox=c('<div class="legend">'+decodeURIComponent(N)+"</div>").css({"text-align":"left"});this.__legendBox.appendTo(this.__getCanvasInner().css({"text-align":"center"}))},addLegendRid:function(N){var O=c("#"+N).clone().removeAttr("id").show();if(typeof O!=="undefined"){this.__legendBox=c('<div class="legend"></div>').css({"text-align":"left"});O.appendTo(this.__legendBox);this.__legendBox.appendTo(this.__getCanvasInner().css({"text-align":"center"}))}},addContent:function(N){c('<div class="content">'+decodeURIComponent(N)+"</div>").appendTo(this.__getCanvasInner())},addClass:function(N){this.__getCanvasInner().addClass(N)},removeClass:function(N){this.__getCanvasInner().removeClass(N)},addStyle:function(N){this.__getCanvasInner().attr("style",this.__getCanvasInner().attr("style")+";"+N)},__getCanvasInner:function(){return this.__canvas.children(".co-inner").size()>0?this.__canvas.children(".co-inner"):this.__canvas},getCanvasElm:function(){var N=this.__cfg;return this.__canvas},__canvasReCalcLocation:function(T){var S=this.__canvas;var R=this.__imagesBox;var N=this.__legendBox;var P={win:undefined,elm:undefined,cnvs:undefined,ibox:undefined,lbox:undefined};P.win={size:{w:c(window).width(),h:c(window).height()},ltc:{left:c(window).scrollLeft(),top:c(window).scrollTop()}};P.elm={size:{w:T.outerWidth(true),h:T.outerHeight(true)},ltc:T.offset()};P.cnvs={size:{w:S.outerWidth(true),h:S.outerHeight(true)}};if(typeof R!=="undefined"){P.ibox={size:{w:R.outerWidth(true),h:R.outerHeight(true)}}}if(typeof N!=="undefined"){P.lbox={size:{w:N.outerWidth(true),h:N.outerHeight(true)}}}var Q=[{n:v,v:(P.elm.ltc.top-P.win.ltc.top)},{n:u,v:((P.win.ltc.top+P.win.size.h)-(P.elm.ltc.top+P.elm.size.h))}];var O=[{n:n,v:(P.elm.ltc.left-P.win.ltc.left)},{n:K,v:((P.win.ltc.left+P.win.size.w)-(P.elm.ltc.left+P.elm.size.w))},];P.spH=O.sort(function(V,U){return U.v-V.v})[0];P.spV=Q.sort(function(V,U){return U.v-V.v})[0];if(P.cnvs.size.w/P.cnvs.size.h<1||P.win.size.w/P.win.size.h>P.cnvs.size.w/P.cnvs.size.h||(P.spH.v>P.cnvs.size.w)){P.spName=P.spH.n}else{P.spName=P.spV.n}switch(P.spName){case n:P.cnvs.ltc={top:P.elm.ltc.top+P.elm.size.h/2-P.cnvs.size.h/2,left:P.elm.ltc.left-P.cnvs.size.w};break;case K:P.cnvs.ltc={top:P.elm.ltc.top+P.elm.size.h/2-P.cnvs.size.h/2,left:P.elm.ltc.left+P.elm.size.w};break;case v:P.cnvs.ltc={top:P.elm.ltc.top-P.cnvs.size.h,left:P.elm.ltc.left+P.elm.size.w/2-P.cnvs.size.w/2};break;case u:P.cnvs.ltc={top:P.elm.ltc.top+P.elm.size.h,left:P.elm.ltc.left+P.elm.size.w/2-P.cnvs.size.w/2};break;default:P.cnvs.ltc=P.elm.ltc}if((P.cnvs.ltc.top+P.cnvs.size.h)>(P.win.ltc.top+P.win.size.h)){P.cnvs.ltc.top-=(P.cnvs.ltc.top+P.cnvs.size.h)-(P.win.ltc.top+P.win.size.h)}if((P.cnvs.ltc.left+P.cnvs.size.w)>(P.win.ltc.left+P.win.size.w)){P.cnvs.ltc.left-=(P.cnvs.ltc.left+P.cnvs.size.w)-(P.win.ltc.left+P.win.size.w)}if(P.cnvs.ltc.top<P.win.ltc.top){P.cnvs.ltc.top=P.win.ltc.top}if(P.cnvs.ltc.left<P.win.ltc.left){P.cnvs.ltc.left=P.win.ltc.left}return P},__canvasArrangeLocation:function(N){var ae=typeof N==="number"?N:0;var R=this.__cfg;var T=this.__canvas;var X=this;var S=R.el;var U=this.__legendBox;var O=this.__imagesBox;var W=T.find("img");W.each(function(){var af=c(this);if(af.data("loaded")===true){af.height("auto")}});if(typeof U!=="undefined"){U.width("auto")}var Z=this.__canvasReCalcLocation(S);if(typeof Z.ibox!=="undefined"&&typeof Z.lbox!=="undefined"&&Z.lbox.size.w>=Z.ibox.size.w){U.css({width:Math.max(Z.ibox.size.w,G)});Z=this.__canvasReCalcLocation(S)}T.css({top:Z.cnvs.ltc.top+"px",left:Z.cnvs.ltc.left+"px"});if(this.__imToLoad===0&&ae<m){var ad={w:Z.cnvs.size.w/(Z.win.size.w*0.95),h:Z.cnvs.size.h/(Z.win.size.h*0.975)};var Y=Math.max(ad.w,ad.h);if(Math.max(ad.w,ad.h)>1){var ab=0;W.each(function(){var af=c(this);if(af.data("loaded")===true){var ag=0;if(af.width()/Y>p){ag=af.width()/Y}else{if(af.width()>p){ag=p}}if(ag>0){ab+=af.width()-ag;af.width(ag)}}});if(ab>1){X.__canvasArrangeLocation(ae+1);return}}var ad={w:(Z.win.size.w*0.95)/Z.cnvs.size.w,h:(Z.win.size.h*0.975)/Z.cnvs.size.h};if(Math.min(ad.w,ad.h)>1){var ac=0;W.each(function(ah){var ai=c(this);var aj=ai.width();var ag=ai.height();ai.width("auto");if(ai.data("loaded")===true&&aj<ai.width()){var af=(1+(Math.min(ad.w,ad.h)-1)*0.5);ai.width(aj*af>ai.width()?"auto":aj*af);ac+=ai.width()-aj}else{ai.width(aj)}});if(ac>1){X.__canvasArrangeLocation(ae+1)}}}else{if(ae<m){var Q=false;var V=W.size();var aa=Z.cnvs.size.w-T.innerWidth()+parseFloat(T.css("padding-left"))+parseFloat(T.css("padding-right"));var P=Z.cnvs.size.h-T.innerHeight()+parseFloat(T.css("padding-top"))+parseFloat(T.css("padding-bottom"));W.each(function(){var af=c(this);if(af.data("loaded")===true){if(af.width()>(Z.win.size.w-aa)/V&&af.width()>p){af.width((Z.win.size.w-aa)/V);Q=true}if(af.height()>(Z.win.size.h-P)/V&&af.width()>p){af.width(af.width()/(af.height()/((Z.win.size.h-P)/V)));Q=true}if(Q&&af.width()<p){af.width(p)}}if(Q){X.__canvasReCalcLocation(S)}})}}}});c.fn.figPopup=function(O){var N={};c.extend(N,{interval:200,delayIn:200,delayOut:200,timeout:200,over:function(P){c(this).trigger(o)},out:function(P){c(this).trigger(z)}});c.extend(N,O);return N};c.fn.extend({tmpfixPMCLinks:function(){return this.map(function(){var N=c(this);var P=N.attr("href");if(typeof P==="string"){var O=P.replace(/(\/+pmc\/+)(PMC\d+)$/,"$1articles/$2").replace(/(\/+pmc\/+articles\/+PMC\d+)$/,"$1/");if(O!==P){N.attr("href",O)}}return this})}})})(jQuery);jQuery(document).ready(function(){var a=new jQuery.fn.figPopup();jQuery("a").tmpfixPMCLinks();jQuery("a.figpopup").hoverIntent(a).popupSensor({statIfLonger:500,delayIn:a.delayIn,delayOut:a.delayOut})})};